(self["webpackJsonpextract-background"]=self["webpackJsonpextract-background"]||[]).push([[0],{37:function(e,t,a){e.exports=function(){return new Worker(a.p+"ce3f83b9f59ef5f75a87.worker.js")}},45:function(e,t,a){e.exports=a(55)},50:function(e,t,a){},51:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(7),o=a.n(s),l=(a(50),a(51),a(11)),c=a(29),i=a(34),m=Object(i.a)(()=>{const e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)({phase:0,value:0}),o=Object(l.a)(s,2),i=o[0],m=o[1],u=Object(n.useState)(0),d=Object(l.a)(u,2),p=d[0],f=d[1],g=Object(n.useState)(0),b=Object(l.a)(g,2);return{fileUrl:a,setFileUrl:r,progress:i,setProgressValue:e=>m(t=>Object(c.a)({},t,{value:e})),incrementProgressPhase:()=>m(e=>Object(c.a)({},e,{phase:e.phase+1})),resetProgress:()=>m({phase:0,value:0}),startPos:p,setStartPos:f,endPos:b[0],setEndPos:b[1]}}),u=a(92),d=a(84);const p=(e,t,a)=>{let n=null;const r=e.target.files;r&&(n=r.item(0),n&&t(n.name)),null==n&&t("\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),((e,t,a)=>{""!==a&&URL.revokeObjectURL(a),e(t?URL.createObjectURL(t):"")})(a.setFileUrl,n,a.fileUrl)};var f=()=>{const e=m.useContainer(),t=Object(n.useState)("\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),a=Object(l.a)(t,2),s=a[0],o=a[1],c=e.progress.value>0;return r.a.createElement("div",{className:"input-video"},r.a.createElement("label",{htmlFor:"input-file-dom"},r.a.createElement(u.a,{variant:"contained",component:"span",disabled:c},r.a.createElement(d.a,null),"\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e: ",r.a.createElement("span",{className:"filename"},s))),r.a.createElement("input",{id:"input-file-dom",type:"file",accept:"video/*",disabled:c,onChange:t=>p(t,o,e)}))},g=a(86),b=a(85),E=a(87),h=a(89),v=a(90),w=a(88),P=a(37),j=a.n(P),y=a(27),O=a(91);var x=()=>{const e=m.useContainer();return r.a.createElement("div",{className:"position-setter",style:{display:"flex",alignItems:"center"}},r.a.createElement(b.a,{variant:"subtitle1",component:"span",style:{verticalAlign:"middle"}},"Position:"," "),r.a.createElement(O.a,{label:"Start",type:"number",value:e.startPos,size:"small",variant:"filled",onChange:t=>{e.setStartPos(+t.target.value)},style:{width:"5em"}}),r.a.createElement(O.a,{label:"End",type:"number",value:e.endPos,size:"small",variant:"filled",onChange:t=>{e.setEndPos(+t.target.value)},style:{width:"5em"}}))};const S=[.05,.1,.2,.3,.5,.8,1],k=async(e,t,a)=>{const n=new URLSearchParams(window.location.search.slice(1)),r="true"===n.get("p_time"),s="true"===n.get("debug");e.readyState<3&&await new Promise(t=>{e.oncanplay=t});const o=await createImageBitmap(e),l=o.width,c=o.height;t.innerHTML="";const i=document.createElement("canvas");i.width=l,i.height=c,t.appendChild(i),s&&console.log(l,c);const m=e.duration,u=i.transferControlToOffscreen(),d=await(async(e,t)=>{const a=Object(y.b)(new j.a),n=await new a;return await n.init(e,Object(y.a)(t,[t])),n})({width:l,height:c},u);let p=0;r&&(p=performance.now());for(const g of S)for(s&&console.log(`start THESHOLD: ${g}`),e.currentTime=a.startPos,a.incrementProgressPhase();e.currentTime<m-a.endPos;){e.readyState<3&&await new Promise(t=>{e.oncanplay=t});try{const t=await createImageBitmap(e),n=await d.apply(Object(y.a)(t,[t]),g);if(-1===n){if(r){const e=performance.now();console.info(`Elapsed Time: ${(e-p)/1e3}s`)}return}s&&console.log(n/(l*c)*100),a.setProgressValue(n/(l*c)*100)}catch(f){console.warn(f)}e.currentTime+=1}};var U=()=>{const e=m.useContainer(),t=Object(n.useRef)(null),a=Object(n.useRef)(null);return r.a.createElement(g.a,{id:"app"},r.a.createElement(b.a,{variant:"h5",component:"h1"},"Extract background"),r.a.createElement(b.a,{component:"p"},"\u52d5\u753b\u304b\u3089\u4eba\u7269(\u4e00\u4eba\u306b\u9650\u308b)\u3092\u53d6\u308a\u9664\u3044\u305f\u80cc\u666f\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002 \u5b9a\u70b9\u304b\u3089\u306e\u6620\u50cf\u3067\u3057\u304b\u6b63\u5e38\u306b\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002 \u307e\u305f\u3001Chrome\u3067\u3057\u304b\u52d5\u4f5c\u3057\u307e\u305b\u3093\u3002 \u5feb\u9069\u306a\u52d5\u4f5c\u306b\u306f\u305d\u3053\u305d\u3053\u306e\u30b9\u30da\u30c3\u30af\u3092\u8981\u6c42\u3057\u307e\u3059\u3002 Position\u306f\u51e6\u7406\u306b\u5229\u7528\u3057\u306a\u3044\u524d\u5f8c\u306e\u79d2\u6570\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002"),r.a.createElement(E.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"flex-start",spacing:1},r.a.createElement(E.a,{item:!0,xs:12},r.a.createElement(x,null)),r.a.createElement(E.a,{item:!0},r.a.createElement(f,null)),r.a.createElement(E.a,{item:!0},r.a.createElement(u.a,{variant:"contained",color:"primary",disabled:""===e.fileUrl||0!==e.progress.phase,onClick:async()=>{t.current&&a.current&&(await k(t.current,a.current,e),e.resetProgress())}},"\u958b\u59cb",r.a.createElement(w.a,null),0!==e.progress.phase&&r.a.createElement(h.a,{size:24,className:"button-loading"})))),r.a.createElement(E.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:1},r.a.createElement(E.a,{item:!0,xs:!0},r.a.createElement(v.a,{variant:"determinate",value:e.progress.value})),r.a.createElement(E.a,{item:!0},e.progress.value.toFixed(4),"%")),r.a.createElement("video",{id:"input",src:e.fileUrl,controls:!0,ref:t}),r.a.createElement("div",{id:"output",ref:a}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(m.Provider,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[45,1,2]]]);
//# sourceMappingURL=main.d1e531d4.chunk.js.map